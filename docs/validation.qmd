---
title: "Validation"
---

## Overview

{{< include _validation-overview.md >}}

## Validation Basics

{{< include _validation-basics.md >}}


## Filtering Transcripts

{{< include _validation-filtering.md >}}


## Validation Splits

Validation cases can be organized into named groups called "splits" (e.g., "dev", "test", "train"). This allows you to maintain a single validation file while selecting different subsets of cases for different purposes.

To use splits, add a `split` column to your validation file:

``` {.default filename="validation.csv"}
id,target,split
Fg3KBpgFr6RSsEWmHBUqeo,true,dev
VFkCH7gXWpJYUYonvfHxrG,false,dev
SiEXpECj7U9nNAvM3H7JqB,true,test
```

Then filter by split when creating your validation set:

``` python
from inspect_scout import validation_set

# Use only dev cases
validation = validation_set("validation.csv", split="dev")

# Use multiple splits
validation = validation_set("validation.csv", split=["dev", "test"])
```

When filtering by split, only cases with matching split values are included. Cases without a split value are excluded when a split filter is applied.


## IDs and Targets {#ids-and-targets}

In the above examples, we provided a validation set of transcript_id =\> boolean. Of course, not every scanner takes a transcript id (some take event or message ids). All of these other variations are supported (including lists of events or messages yielded by a custom [Loader](scanners.qmd#loader)). You can also use any valid JSON value as the `target`

For example, imagine we have a scanner that counts the incidences of "backtracking" in reasoning traces. In this case our scanner yields a number rather than a boolean. So our validation set would be message_id =\> number:

``` {.default filename="backtracking.csv"}
id,target
Fg3KBpgFr6RSsEWmHBUqeo,2
VFkCH7gXWpJYUYonvfHxrG,0
SiEXpECj7U9nNAvM3H7JqB,3
```

In the case of a custom loader (.e.g. one that extracts user/assistant message pairs) we can also include multiple IDs:

``` {.default filename="validation.csv"}
id,target
"Fg3KBpgFr6RSsEWmHBUqeo,VFkCH7gXWpJYUYonvfHxrG",true
```

### Result Set Validation

When a scanner returns a list of multiple results (see [Multiple Results](scanners.qmd#multiple-results)), you can validate each labeled result separately using label-based validation. This is particularly useful for scanners that detect multiple types of findings in a single transcript.

#### Format

For CSV files, use `label_*` columns:

``` {.default filename="security-validation.csv"}
id, label_deception, label_jailbreak, label_misconfig
Fg3KBpgFr6RSsEWmHBUqeo, true, false, false
VFkCH7gXWpJYUYonvfHxrG, false, true, false
SiEXpECj7U9nNAvM3H7JqB, false, false, true
```

For YAML/JSON files, use a labels key instead of target:

``` yaml
- id: Fg3KBpgFr6RSsEWmHBUqeo 
  labels: 
    deception: true 
    jailbreak: false 
    misconfig: false

- id: VFkCH7gXWpJYUYonvfHxrG 
  labels: 
    deception: false 
    jailbreak: true 
    misconfig: false
```

#### Validation Semantics

Label-based validation uses "at least one" logic: if any result with a given label matches the expected value, validation passes for that label. For example, if a scanner returns multiple deception results for a transcript and at least one has `value==True`, then validation passes if the expected value is true.

Missing labels are treated as negative/absent values. If your validation set expects `label_phishing: false` but the scanner returns no results with `label=="phishing"`, the validation passes because the absence is treated as False.

### Comparison Predicates

The examples above all use straight equality checks as their predicate. You can provide an alternate predicate either by name (e.g. "gt", "gte", "contains") or with a custom function. Specify the `ValidationPredicate` as a parameter to the `validation_set()` function:

``` python
validation_set(cases="validation.csv", predicate="gte")
```

### Value Dictionary

If our scanner produces a `dict` of values, we can also build a validation dataset which provides ground truth for each distinct field in the `dict`. To do this, we introduce `target_*` column names as follows:

``` {.default filename="validation.csv"}
id, target_deception, target_backtracks
Fg3KBpgFr6RSsEWmHBUqeo, true, 2
VFkCH7gXWpJYUYonvfHxrG, false, 0
```

## File Formats {#validation-files}

You can specify a `ValidationSet` either in code, as a CSV, or as a YAML or JSON file. 

### CSV

Here are the various ways you can structure a validation CSV for different scenarios:

| Format | Header Row | Example |
|--------|------------|---------|
| Single target | `id,target` | `id,target`<br>`abc123,true` |
| Dict targets | `id,target_*,...` | `id,target_foo,target_bar`<br>`abc123,true,42` |
| Label validation | `id,label_*,...` | `id,label_deception,label_jailbreak`<br>`abc123,true,false` |
| With splits | `id,target,split` | `id,target,split`<br>`abc123,true,dev` |

### YAML

Here is what a YAML file would look like for a single target:

``` {.yaml filename="validation.yaml"}
- id: Fg3KBpgFr6RSsEWmHBUqeo
  target: true

- id: VFkCH7gXWpJYUYonvfHxrG
  target: false
```

Here is a YAML file for multiple targets:

``` {.yaml filename="validation.yaml"}
- id: Fg3KBpgFr6RSsEWmHBUqeo
  target:
     deception: true
     backtracks: 2

- id: VFkCH7gXWpJYUYonvfHxrG
  target:
     deception: false
     backtracks: 0
```

Here is a YAML file for label-based validation (resultsets):

``` {.yaml filename="validation.yaml"}
- id: Fg3KBpgFr6RSsEWmHBUqeo
  labels:
     deception: true
     jailbreak: false
     misconfig: false

- id: VFkCH7gXWpJYUYonvfHxrG
  labels:
     deception: false
     jailbreak: true
     misconfig: false
```

Here is a YAML file with splits using the flat format (split field on each case):

``` {.yaml filename="validation.yaml"}
- id: Fg3KBpgFr6RSsEWmHBUqeo
  target: true
  split: dev

- id: VFkCH7gXWpJYUYonvfHxrG
  target: false
  split: test
```

You can also use a nested format that groups cases by split:

``` {.yaml filename="validation.yaml"}
- split: dev
  cases:
    - id: Fg3KBpgFr6RSsEWmHBUqeo
      target: true
    - id: VFkCH7gXWpJYUYonvfHxrG
      target: false

- split: test
  cases:
    - id: SiEXpECj7U9nNAvM3H7JqB
      target: true
```



