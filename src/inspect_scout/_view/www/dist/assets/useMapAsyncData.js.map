{"version":3,"file":"useMapAsyncData.js","sources":["../../src/hooks/useMapAsyncData.ts"],"sourcesContent":["import { useMemo } from \"react\";\n\nimport { AsyncData, loading } from \"../utils/asyncData\";\n\n/**\n * The `useMapAsyncData` function is a custom React hook that transforms the data\n * in an `AsyncData` object or an array of `AsyncData` objects. It uses the `useMemo`\n * hook to avoid unnecessary recalculations.\n *\n * @template TBefore - The type of the data before the transformation\n * @template TAfter - The type of the data after the transformation\n * @param {AsyncData<TBefore> | AsyncData<TBefore>[]} input - The `AsyncData` object(s)\n * to transform\n * @param {(before: TBefore) => TAfter} transform - The function to transform the\n * data\n * @param {(err: Error) => Error} [errorTransform] - The function to transform any\n * errors (optional)\n * @returns {AsyncData<TAfter> | AsyncData<TAfter>[]} - The transformed `AsyncData`\n * object(s)\n *\n * @example\n * ```typescript\n * const asyncData = { loading: false, data: 5 };\n * const transform = (num: number) => num * 2;\n * const result = useMapAsyncData(asyncData, transform);\n * console.log(result); // { loading: false, data: 10 }\n * ```\n */\nexport function useMapAsyncData<TBefore, TAfter>(\n  input: AsyncData<TBefore>,\n  transform: (before: TBefore) => TAfter,\n  errorTransform?: (err: Error) => Error\n): AsyncData<TAfter>;\nexport function useMapAsyncData<TBefore, TAfter>(\n  input: AsyncData<TBefore>[],\n  transform: (before: TBefore) => TAfter,\n  errorTransform?: (err: Error) => Error\n): AsyncData<TAfter>[];\nexport function useMapAsyncData<TBefore, TAfter>(\n  input: AsyncData<TBefore> | AsyncData<TBefore>[],\n  transform: (before: TBefore) => TAfter,\n  errorTransform?: (err: Error) => Error\n): AsyncData<TAfter> | AsyncData<TAfter>[] {\n  return useMemo(() => {\n    const isArray = Array.isArray(input);\n    const mapped = (isArray ? input : [input]).map<AsyncData<TAfter>>(\n      (item) => {\n        if (item.error) {\n          const error = errorTransform\n            ? errorTransform(item.error)\n            : item.error;\n          return { loading: false, error };\n        }\n        if (item.loading) return loading;\n\n        try {\n          return { loading: false, data: transform(item.data) };\n        } catch (error: unknown) {\n          if (!(error instanceof Error))\n            throw Error(\n              `useMapAsyncData only supports catching Error's: ${JSON.stringify(error)}`\n            );\n          return { loading: false, error };\n        }\n      }\n    );\n    if (!isArray) {\n      const [onlyItem] = mapped;\n      if (!onlyItem) throw Error(\"useMapAsyncData: Array must have one item.\");\n      return onlyItem;\n    }\n    return mapped;\n  }, [input, transform, errorTransform]);\n}\n"],"names":["useMemo"],"mappings":";AAsCO,SAAS,gBACd,OACA,WACA,gBACyC;AACzC,SAAOA,aAAAA,QAAQ,MAAM;AACnB,UAAM,UAAU,MAAM,QAAQ,KAAK;AACnC,UAAM,UAAU,UAAU,QAAQ,CAAC,KAAK,GAAG;AAAA,MACzC,CAAC,SAAS;AACR,YAAI,KAAK,OAAO;AACd,gBAAM,QAEF,KAAK;AACT,iBAAO,EAAE,SAAS,OAAO,MAAA;AAAA,QAC3B;AACA,YAAI,KAAK,QAAS,QAAO;AAEzB,YAAI;AACF,iBAAO,EAAE,SAAS,OAAO,MAAM,UAAU,KAAK,IAAI,EAAA;AAAA,QACpD,SAAS,OAAgB;AACvB,cAAI,EAAE,iBAAiB;AACrB,kBAAM;AAAA,cACJ,mDAAmD,KAAK,UAAU,KAAK,CAAC;AAAA,YAAA;AAE5E,iBAAO,EAAE,SAAS,OAAO,MAAA;AAAA,QAC3B;AAAA,MACF;AAAA,IAAA;AAEF,QAAI,CAAC,SAAS;AACZ,YAAM,CAAC,QAAQ,IAAI;AACnB,UAAI,CAAC,SAAU,OAAM,MAAM,4CAA4C;AACvE,aAAO;AAAA,IACT;AACA,WAAO;AAAA,EACT,GAAG,CAAC,OAAO,WAAW,cAAc,CAAC;AACvC;"}